---
type Props = {
  title: string;
  description?: string;
  canonicalUrl: string;
  pageType?: 'website' | 'article';
  pubDate?: Date;
};

const {
  title,
  description = '记录星树浩 × 小野。这里发布确认后的每日总结。',
  canonicalUrl,
  pageType = 'website',
  pubDate,
} = Astro.props;

const siteName = 'LoveClaw';

// Optional: Cloudflare Web Analytics token (set in Cloudflare Pages env vars)
const cfAnalyticsToken = import.meta.env.PUBLIC_CF_ANALYTICS_TOKEN;
---

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content={Astro.generator} />
<title>{title}</title>

<link rel="canonical" href={canonicalUrl} />
<link rel="alternate" type="application/rss+xml" title={`${siteName} RSS`} href="/rss.xml" />

<meta name="description" content={description} />

<meta property="og:site_name" content={siteName} />
<meta property="og:type" content={pageType} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={canonicalUrl} />

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />

{pageType === 'article' && pubDate ? (
  <meta property="article:published_time" content={pubDate.toISOString()} />
) : null}

<style>
  :root { color-scheme: light dark; }
  body {
    max-width: 860px;
    margin: 40px auto;
    padding: 0 16px;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  }
  header { display:flex; justify-content:space-between; align-items:baseline; gap:12px; flex-wrap: wrap; }
  h1 { margin: 0 0 8px; }
  .muted { opacity: .75; }
  ul { padding-left: 18px; }
  li { margin: 10px 0; }
  a { text-decoration: none; }
  a:hover { text-decoration: underline; }
  .date { font-variant-numeric: tabular-nums; opacity:.75; margin-left:8px; }
  article :global(h1,h2,h3) { margin-top: 1.2em; }
  article :global(p,li) { line-height: 1.7; }
  pre { padding: 12px; overflow: auto; border: 1px solid rgba(128,128,128,.25); border-radius: 8px; }
  code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
</style>

{cfAnalyticsToken ? (
  <script
    defer
    src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon={JSON.stringify({ token: cfAnalyticsToken })}
  />
) : null}
